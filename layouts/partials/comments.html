<style>
  .comment-toggle {
    margin-bottom: 1em;
    text-align: center;
  }
  
  .comment-toggle button {
    padding: 0.5em 1.2em;
    margin: 0 0.3em;
    cursor: pointer;
    border: 1px solid #ccc;
    background: #f8f8f8;
    color: #555;
    font-weight: 500;
    border-radius: 4px;
    font-size: 0.9rem;
    transition: background 0.2s, color 0.2s, border-color 0.2s;
  }
  
  .comment-toggle button:hover {
    background: #e2e2e2;
    border-color: #999;
    color: #333;
  }
  
  .comment-toggle button.active {
    background: #ccc;
    border-color: #999;
    color: #222;
    cursor: default;
    pointer-events: none;
  }
  
  .comment-system {
    display: none;
  }
  
  .comment-system.active {
    display: block;

  .comment-invite{
  text-align:center;
  margin: 1.2em 0 .6em;
}
.comment-invite__title{
  font-size: 1rem;
  font-weight: 500;
}
.comment-invite__sub{
  margin-top: .25em;
  font-size: .9rem;
  opacity: .75;
}  
  }
  /* ï¼ˆæ”¾åœ¨ä½ ç°æœ‰çš„ <style> ä¹‹åï¼‰ */
/* è®©è¯„è®ºåŒºç»§æ‰¿æ­£æ–‡çš„å­—ä½“ã€å­—å·å’Œå­—é‡ */
html[lang="en-US"] .comment-system,
html[lang="en-US"] .comment-system * {
  font-family: "Georgia", "Times New Roman", serif !important;
  font-size: 1rem !important;
  font-weight: 400 !important;
  line-height: 1.6 !important;
}


{{/* ---- Comment invite (no JS) ---- */}}

{{- $invites := dict
  "zh" (slice
    (dict "t" "ä½ çš„ç•™è¨€ï¼Œæ˜¯æˆ‘ç»§ç»­å†™ä¸‹å»çš„åŠ¨åŠ› ğŸ‘‡" "s" "çŸ­å¥ä¹Ÿå¾ˆçè´µï¼Œæˆ‘ä¼šè®¤çœŸè¯»ã€‚")
    (dict "t" "å¦‚æœè¿™ç¯‡å¯¹ä½ æœ‰ä¸€ç‚¹å¸®åŠ©ï¼Œæ¬¢è¿ç•™ä¸€å¥è¯è®©æˆ‘çŸ¥é“ ğŸ‘‡" "s" "å“ªæ€•ä¸€ä¸ªè¡¨æƒ…ä¹Ÿå¯ä»¥ã€‚")
    (dict "t" "ä¸€å¥è¯å°±å¥½ï¼šä½ çœ‹å®Œæœ€å¤§çš„æ”¶è·æ˜¯ä»€ä¹ˆï¼ŸğŸ‘‡" "s" "æˆ‘æƒ³çŸ¥é“ä½ å¸¦èµ°äº†ä»€ä¹ˆã€‚")
    (dict "t" "çœ‹åˆ°ä½ å‚ä¸ï¼Œæˆ‘å°±çŸ¥é“è¿™ç¯‡æ²¡æœ‰ç™½å†™ ğŸ‘‡" "s" "è°¢è°¢ä½ æŠŠæ—¶é—´ç•™åœ¨è¿™é‡Œã€‚")
  )
  "en" (slice
    (dict "t" "Your comment keeps me writing. ğŸ‘‡" "s" "Even a short note means a lot.")
    (dict "t" "One line is enough: whatâ€™s your biggest takeaway? ğŸ‘‡" "s" "Iâ€™d love to hear what you took from this.")
    (dict "t" "Thanks for being hereâ€”this wasnâ€™t written into the void. ğŸ‘‡" "s" "I read every note.")
  )
  "ja" (slice
    (dict "t" "ã‚³ãƒ¡ãƒ³ãƒˆãŒã€æ›¸ãç¶šã‘ã‚‹åŠ›ã«ãªã‚Šã¾ã™ ğŸ‘‡" "s" "çŸ­ãã¦ã‚‚å¤§ä¸ˆå¤«ã€‚å…¨éƒ¨èª­ã¿ã¾ã™ã€‚")
    (dict "t" "å°‘ã—ã§ã‚‚å½¹ã«ç«‹ã£ãŸã‚‰ã€ä¸€è¨€ã ã‘ã§ã‚‚æ®‹ã—ã¦ãã‚Œã‚‹ã¨å¬‰ã—ã„ã§ã™ ğŸ‘‡" "s" "çµµæ–‡å­—ã ã‘ã§ã‚‚OKã§ã™ã€‚")
  )
-}}

{{- $lang := .Lang -}}
{{- $list := index $invites $lang -}}
{{- if not $list -}}
  {{- $list = index $invites "en" -}}
{{- end -}}

{{- $seedBase := (default .RelPermalink .File.Path) -}}
{{- $seed := printf "%s|%s" $lang $seedBase -}}
{{- $idx := int (mod (crypto.FNV32a $seed) (len $list)) -}}
{{- $pick := index $list $idx -}}

<div class="comment-invite">
  <div class="comment-invite__title">{{ $pick.t }}</div>
  <div class="comment-invite__sub">{{ $pick.s }}</div>
</div>



/* å¦‚æœä½ ä¹Ÿå¸Œæœ›ä¸­æ–‡åŒºï¼ˆGiscusï¼‰åœ¨ä¸­æ–‡é¡µé¢ç”¨é»˜è®¤ä¸­æ–‡å­—ä½“ï¼Œå¯ä»¥è¿™æ · */
html[lang="zh-CN"] .comment-system,
html[lang="zh-CN"] .comment-system * {
  font-family: 'KingHwa_OldSong', sans-serif !important;
  font-size: 1rem !important;
  font-weight: 400 !important;
  line-height: 1.8 !important;
}
  </style>
  
  <div class="comment-toggle">
    <button id="btn-twikoo">Twikoo ğŸ’¬</button>
    <button id="btn-giscus">Giscus ğŸ’¬</button>
  </div>
  
  <div id="twikoo-container" class="comment-system">
    <!-- Twikoo è¯„è®ºä»£ç  -->
    <div id="twikoo"></div>
    <script src="https://registry.npmmirror.com/twikoo/1.6.40/files/dist/twikoo.all.min.js"></script>
 <script>
  /* 1) UI è¯­è¨€ï¼šéšé¡µé¢è¯­è¨€ */
  {{ $twikooLang := "en" }}
  {{ if eq .Lang "zh" }}{{ $twikooLang = "zh-CN" }}{{ end }}

  /* 2) è¯„è®ºçº¿ç¨‹IDï¼šä¼˜å…ˆ translationKeyï¼›å¦åˆ™ç»´æŒä½ ç°åœ¨çš„â€œç»Ÿä¸€åˆ°ä¸­æ–‡URLâ€åšæ³• */
  {{ $twikooPath := "" }}

  {{ with .Params.translationKey }}
    {{/* ä½ è‡ªå·±åœ¨ front matter å†™äº† translationKey */}}
    {{ $twikooPath = printf "tk:%s" . }}
  {{ else }}
    {{/* æ²¡å†™ translationKeyï¼šä¿æŒç°çŠ¶ï¼Œç»Ÿä¸€åˆ°ä¸­æ–‡ permalink */}}
    {{ $twikooPath = .RelPermalink }}
    {{ if eq .Lang "en" }}
      {{/* æœ‰ä¸­æ–‡è¯‘æ–‡å°±ç”¨å®ƒï¼ˆæœ€ç¨³ï¼‰ï¼Œæ²¡æœ‰å† replace */}}
      {{ $found := false }}
      {{ range .Translations }}
        {{ if eq .Lang "zh" }}
          {{ $twikooPath = .RelPermalink }}
          {{ $found = true }}
        {{ end }}
      {{ end }}
      {{ if not $found }}
        {{ $twikooPath = replace $twikooPath "/en/" "/zh/" }}
      {{ end }}
    {{ end }}
  {{ end }}

  twikoo.init({
    envId: "{{ .Site.Params.twikoo.id }}",
    el: "#twikoo",
    region: "{{ .Site.Params.twikoo.region }}",
    lang: "{{ $twikooLang }}",
    path: "{{ $twikooPath }}",
  })
</script>  
  </div>
  
  <div id="giscus-container" class="comment-system">
    <!-- Giscus è¯„è®ºä»£ç  -->
    <div id="giscus-comment"></div>
    <script src="https://giscus.app/client.js"
            data-repo="Liuqiran/liuqiran.github.io"
            data-repo-id="R_kgDONiVddQ"
            data-category="General"
            data-category-id="DIC_kwDONiVddc4CljSp"
            data-mapping="title"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="preferred_color_scheme"
            data-lang="{{ if eq .Site.Language.Lang "zh" }}zh-CN{{ else }}en{{ end }}"
            crossorigin="anonymous"
            async>
    </script>
  </div>
  
  <script>
    const btnTwikoo = document.getElementById('btn-twikoo');
    const btnGiscus = document.getElementById('btn-giscus');
    const twikooContainer = document.getElementById('twikoo-container');
    const giscusContainer = document.getElementById('giscus-container');
  
    function showTwikoo() {
      btnTwikoo.classList.add('active');
      btnGiscus.classList.remove('active');
      twikooContainer.classList.add('active');
      giscusContainer.classList.remove('active');
      localStorage.setItem('preferredComment', 'twikoo');
    }
  
    function showGiscus() {
      btnGiscus.classList.add('active');
      btnTwikoo.classList.remove('active');
      giscusContainer.classList.add('active');
      twikooContainer.classList.remove('active');
      localStorage.setItem('preferredComment', 'giscus');
    }
  
    btnTwikoo.onclick = showTwikoo;
    btnGiscus.onclick = showGiscus;
  
    window.addEventListener('DOMContentLoaded', () => {
      const preferred = localStorage.getItem('preferredComment');
      if (preferred === 'giscus') {
        showGiscus();
      } else {
        // é»˜è®¤ Twikoo
        showTwikoo();
      }
    });
  </script>