{{- define "main" }}

<header class="page-header">
  <!-- 保持原有的 header 部分不变 -->
  ... 
</header>

{{- $pages := where site.RegularPages "Lang" "in" (slice "en" "zh") }}

{{- if site.Params.ShowAllPagesInArchive }}
{{- $pages = site.RegularPages }}
{{- end }}

{{- range $pages.GroupByPublishDate "2006" }}
{{- if ne .Key "0001" }}
<div class="archive-year">
  {{- $year := replace .Key "0001" "" }}
  <h2 class="archive-year-header" id="{{ $year }}">
    <button class="collapse-button" onclick="toggleYear(this, '{{ $year }}')" aria-label="折叠/展开 {{ $year }}">
      <span class="collapse-icon">▼</span>
    </button>
    <a class="archive-header-link" href="#{{ $year }}">
      {{- $year -}}
    </a>
    <sup class="archive-count">&nbsp;{{ len .Pages }}</sup>
  </h2>
  <div id="year-content-{{ $year }}" class="year-content">
    {{- range .Pages.GroupByDate "January" }}
    <div class="archive-month">
      <h3 class="archive-month-header" id="{{ $year }}-{{ .Key }}">
        <a class="archive-header-link" href="#{{ $year }}-{{ .Key }}">
          {{- .Key -}}
        </a>
        <sup class="archive-count">&nbsp;{{ len .Pages }}</sup>
      </h3>
      <div class="archive-posts">
        {{- range .Pages }}
        {{- if eq .Kind "page" }}
        <div class="archive-entry">
          <!-- 保持原有的 entry 部分不变 -->
          ...
        </div>
        {{- end }}
        {{- end }}
      </div>
    </div>
    {{- end }}
  </div>
</div>
{{- end }}
{{- end }}

<!-- 添加 JavaScript 代码 -->
<script>
function toggleYear(button, year) {
    const content = document.getElementById(`year-content-${year}`);
    const icon = button.querySelector('.collapse-icon');
    
    if (content.style.display === 'none') {
        content.style.display = 'block';
        icon.textContent = '▼';
    } else {
        content.style.display = 'none';
        icon.textContent = '▶';
    }
}

// 页面加载时默认折叠所有年份（可选）
document.addEventListener('DOMContentLoaded', function() {
    const yearContents = document.querySelectorAll('.year-content');
    yearContents.forEach(content => {
        content.style.display = 'none';
    });
    const icons = document.querySelectorAll('.collapse-icon');
    icons.forEach(icon => {
        icon.textContent = '▶';
    });
});
</script>

<!-- 添加样式 -->
<style>
.collapse-button {
    background: none;
    border: none;
    padding: 0 8px;
    cursor: pointer;
    color: var(--primary);
}

.collapse-button:hover {
    color: var(--secondary);
}

.collapse-icon {
    display: inline-block;
    transition: transform 0.2s;
}

.archive-year-header {
    display: flex;
    align-items: center;
}

.year-content {
    margin-left: 20px;
}
</style>

{{- end }}{{/* end main */}}
