<style>

.weektable-wrapper {
  max-height: 300px;      /* é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œæ•°å­—å¯è°ƒ */
  overflow-y: auto;       /* è¶…è¿‡é«˜åº¦æ˜¾ç¤ºå‚ç›´æ»šåŠ¨æ¡ */
  border-radius: 12px;    /* ä¿æŒåœ†è§’ */
  border: 2px solid #a8dadc;  /* åŸè¡¨æ ¼çš„è¾¹æ¡†æ”¹åˆ°è¿™é‡Œ */
  box-shadow: 0 4px 8px rgba(168, 218, 220, 0.3); /* åŸè¡¨æ ¼é˜´å½±æ”¹åˆ°è¿™é‡Œ */
}
    .weektable {
      border-collapse: separate; /* å¿…é¡»ç”¨separateæ‰èƒ½ç”Ÿæ•ˆåœ†è§’ */
      border-spacing: 0;
      border: 1px solid #a8dadc;
      border-radius: 12px;
      width: 100%;

    }
  
    .weektable th, .weektable td {
      padding: 12px 16px;
      border-bottom: 1px solid #a8dadc;
      text-align: center;
      color: #264653;
    }
  
    .weektable thead th {
      background-color: #457b9d;
      color: #f1faee;
      font-weight: 600;
    }
  
    .weektable tbody tr:last-child td {
      border-bottom: none;
    }
  
    .weektable tbody tr:hover {
      background-color: #f1faee;
      cursor: default;
    }
  
    .weektable tbody tr.hide-row {
      display: none;
    }
  
    .weektable-toggle {
      cursor: pointer;
      color: #1d3557;
      user-select: none;
      margin-bottom: 0.5em;
      display: inline-block;
      font-weight: 600;
    }

    .cell-content {
    display: flex;
    justify-content: center; /* æ°´å¹³å±…ä¸­æ•´ä½“å†…å®¹ */
    align-items: center;     /* å‚ç›´å±…ä¸­ */
    gap: 6px;                /* æ•°å­—å’Œç®­å¤´é—´è· */
  }
  .cell-value {
    flex: none;              /* æ•°å­—ä¸ä¼¸ç¼© */
    text-align: center;
    min-width: 30px;         /* å›ºå®šå®½åº¦ï¼Œç¡®ä¿æ•°å­—åˆ—å®½ä¸€è‡´ */
  }
  .arrow {
    flex: none;
  }
  .arrow.up {
    color: green;
  }
  .arrow.down {
    color: red;
  }

  </style>
  
  <span class="weektable-toggle" onclick="toggleWeekRows(this)">Show more weeks â–¼</span>

  <div class="weektable-wrapper" tabindex="0" style="outline:none;">

  
  <table class="weektable">
    <thead>
      <tr>
        <th>Week No.</th>
        <th>ğŸ”„ Overall Habit Score</th>
        <th>ğŸ² Clean diet (%)</th>
        <th>ğŸ›ï¸ Timely Sleep (%)</th>
        <th>ğŸ‘Ÿ Regular Exercise (%)</th>
        <th>ğŸ“– Reading Time (mins)</th>
      </tr>
    </thead>
    <tbody>
        {{ $rows := split .Inner "\n" }}
        {{ range $index, $row := $rows }}
          {{ if gt $index 0 }}
            {{ $cells := split $row "," }}
            <tr class="{{ if ge $index 4 }}hide-row{{ end }}">
              {{ range $i, $cell := $cells }}
                {{ $val := trim $cell " " }}
                <td>
                    <div class="cell-content">
                      <div class="cell-value">{{ $val }}</div>
                  
                      {{ if and (ge $i 1) (lt $index (sub (len $rows) 1)) }}
                        {{/* ç®­å¤´é€»è¾‘ä¸å˜ï¼Œåªæ˜¯æŠŠç®­å¤´æ”¾è¿™é‡Œ */}}
                        {{ $nextRow := index $rows (add $index 1) }}
                        {{ $nextCells := split $nextRow "," }}
                        {{ $nextVal := 0 }}
                        {{ if lt $i (len $nextCells) }}
                          {{ $nextVal = (float (trim (index $nextCells $i) " ")) }}
                        {{ end }}
                        {{ $currVal := float (replace $val "%" "") }}
                  
                        {{ if and (ne $nextVal 0) (ne $currVal 0) }}
                          {{ $diff := sub $currVal $nextVal }}
                          {{ $absDiff := cond (lt $diff 0) (mul $diff -1) $diff }}
                          {{ $percentChange := div (mul $absDiff 100) $nextVal }}
                  
                          {{ $arrowCount := 1 }}
                          {{ if ge $percentChange 75 }}
                            {{ $arrowCount = 3 }}
                          {{ else if ge $percentChange 50 }}
                            {{ $arrowCount = 2 }}
                          {{ end }}
                  
                          {{ if lt $currVal $nextVal }}
                            {{ range seq 1 $arrowCount }}
                              <span class="arrow down">â–¼</span>
                            {{ end }}
                          {{ else if gt $currVal $nextVal }}
                            {{ range seq 1 $arrowCount }}
                              <span class="arrow up">â–²</span>
                            {{ end }}
                          {{ end }}
                        {{ end }}
                      {{ end }}
                  
                    </div>
                  </td>
                  
              {{ end }}
            </tr>
          {{ end }}
        {{ end }}
      </tbody>
  </table>  

</div>
  
  <script>
    function toggleWeekRows(el) {
      const hiddenRows = document.querySelectorAll(".weektable tbody tr.hide-row");
      if (hiddenRows.length === 0) return;
  
      let isHidden = hiddenRows[0].style.display === "none" || hiddenRows[0].style.display === "";
      hiddenRows.forEach(row => {
        row.style.display = isHidden ? "table-row" : "none";
      });
      el.textContent = isHidden ? "Show fewer weeks â–²" : "Show more weeks â–¼";
    }
  
    document.addEventListener("DOMContentLoaded", function () {
      const hiddenRows = document.querySelectorAll(".weektable tbody tr.hide-row");
      hiddenRows.forEach(row => {
        row.style.display = "none";
      });
    });
  </script>
  